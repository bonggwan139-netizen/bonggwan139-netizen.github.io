<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>DBC | 지도</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body { margin:0 }
    #map { height: 100vh; }

    /* 좌측 상단 레이어 컨트롤 기본 스타일 유지 */

    /* 우측 상단: 방위(컴퍼스) – 아이콘을 작게(기존의 1/2) */
    .leaflet-control.compass.leaflet-bar {
      background:#fff; border:1px solid #ccc; border-radius:6px;
      padding:4px 6px; box-shadow:0 1px 3px rgba(0,0,0,.15); font:12px/1.2 system-ui;
    }
    .compass .arrow-wrap {
      width:30px; height:30px; display:flex; align-items:center; justify-content:center;
    }
    .compass .label { text-align:center; font-weight:700; color:#333; font-size:10px; margin-top:2px; }
  </style>
</head>
<body>
  <header style="border-bottom:1px solid #eee; position:sticky; top:0; background:#fff; z-index:1000;">
    <nav style="max-width:1000px; margin:0 auto; padding:14px 20px; display:flex; gap:16px; align-items:center;">
      <strong style="font-size:18px;">DBC</strong>
      <a href="index.html">홈</a>
      <a href="about.html">소개</a>
      <a href="map.html"><b>지도</b></a>
    </nav>
  </header>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const KEY = "3C11E290-3F00-3957-8B03-FB4CB582692F";              // ← VWorld 키
    const COMPASS_RGB = "18, 52, 102";          // ← 방위 화살표 색상 (남색계열). 원하는 RGB로만 바꾸면 됨.

    // 지도 생성 (제주특별자치도청 중심)
    const map = L.map('map', { zoomControl: true }).setView([33.4890, 126.4983], 13);

    // ----- 베이스맵 -----
    const street = L.tileLayer(
      `https://api.vworld.kr/req/wmts/1.0.0/${KEY}/Base/{z}/{y}/{x}.png`,
      { maxZoom: 19, attribution: '&copy; VWorld' }
    );
    const satellite = L.tileLayer(
      `https://api.vworld.kr/req/wmts/1.0.0/${KEY}/Satellite/{z}/{y}/{x}.jpeg`,
      { maxZoom: 19, attribution: '&copy; VWorld' }
    );
    street.addTo(map);

    // ----- 레이어 선택(좌측 상단) : 일반 / 위성 -----
    L.control.layers({ '일반': street, '위성': satellite }, {}, { position:'topleft', collapsed:false }).addTo(map);

    // ----- 방위(우측 상단) : 1/2 크기, 화살표 아이콘, RGB 색상 적용 -----
    const CompassControl = L.Control.extend({
      options: { position: 'topright' },
      onAdd: function () {
        const container = L.DomUtil.create('div', 'leaflet-control compass leaflet-bar');
        container.innerHTML = `
          <div class="arrow-wrap">
            <!-- 30x30 SVG, 위를 향하는 화살표. fill을 rgb(COMPASS_RGB)로 -->
            <svg width="30" height="30" viewBox="0 0 30 30" aria-label="north">
              <!-- 외곽선이 필요한 경우 stroke 추가 가능 -->
              <polygon points="15,2 26,26 15,21 4,26" fill="rgb(${COMPASS_RGB})"></polygon>
            </svg>
          </div>
          <div class="label">N</div>
        `;
        L.DomEvent.disableClickPropagation(container);
        L.DomEvent.disableScrollPropagation(container);
        return container;
      }
    });
    map.addControl(new CompassControl());

    // ----- 축척(우측 하단, 미터 단위) -----
    L.control.scale({ position: 'bottomright', metric: true, imperial: false }).addTo(map);

    // 테스트 마커: 제주특별자치도청
    L.marker([33.4890, 126.4983]).addTo(map).bindPopup("제주특별자치도청").openPopup();
  </script>
</body>
</html>
